import{d as B,O as M,X as U,P as d,S as I,I as N,J as G,F as H,B as W,j as F,y as J}from"./index.de7a3c72.js";import{c as R,a as V,d as P,e as D,p as O,b as C,g as X,f as k,h as T,i as b,j as q,k as z,m as Q,l as Y}from"./util.0173355c.js";var Z=function(){},$=Z;function w(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,a)}return t}function j(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?w(Object(t),!0).forEach(function(a){A(n,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(t,a))})}return n}function A(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ee(n){return re(n)||ne(n)||ae(n)||te()}function te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ae(n,e){if(!!n){if(typeof n=="string")return S(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(n,e)}}function ne(n){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(n))return Array.from(n)}function re(n){if(Array.isArray(n))return S(n)}function S(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=n[t];return a}function m(){return m=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},m.apply(this,arguments)}function de(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e={};return n.forEach(function(t){e[t]={handler:function(){this.needSyncKeys[t]=!0},flush:"sync"}}),e}var oe=B({name:"Tree",mixins:[M],provide:function(){return{vcTree:this}},inheritAttrs:!1,props:U({prefixCls:d.string,tabindex:d.oneOfType([d.string,d.number]),children:d.any,treeData:d.array,showLine:d.looseBool,showIcon:d.looseBool,icon:d.oneOfType([d.object,d.func]),focusable:d.looseBool,selectable:d.looseBool,disabled:d.looseBool,multiple:d.looseBool,checkable:I(d.oneOfType([d.object,d.looseBool])),checkStrictly:d.looseBool,draggable:d.looseBool,defaultExpandParent:d.looseBool,autoExpandParent:d.looseBool,defaultExpandAll:d.looseBool,defaultExpandedKeys:d.array,expandedKeys:d.array,defaultCheckedKeys:d.array,checkedKeys:d.oneOfType([d.array,d.object]),defaultSelectedKeys:d.array,selectedKeys:d.array,loadData:d.func,loadedKeys:d.array,filterTreeNode:d.func,openTransitionName:d.string,openAnimation:d.oneOfType([d.string,d.object]),switcherIcon:d.any,__propsSymbol__:d.any},{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[]}),data:function(){$(this.$props.__propsSymbol__),$(this.$props.children),this.needSyncKeys={},this.domTreeNodes={};var e={_posEntities:new Map,_keyEntities:new Map,_expandedKeys:[],_selectedKeys:[],_checkedKeys:[],_halfCheckedKeys:[],_loadedKeys:[],_loadingKeys:[],_treeNode:[],_prevProps:null,_dragOverNodeKey:"",_dropPosition:null,_dragNodesKeys:[]};return m(m({},e),this.getDerivedState(N(this),e))},watch:m(m({},de(["treeData","children","expandedKeys","autoExpandParent","selectedKeys","checkedKeys","loadedKeys"])),{__propsSymbol__:function(){this.setState(this.getDerivedState(N(this),this.$data)),this.needSyncKeys={}}}),methods:{getDerivedState:function(e,t){var a=t._prevProps,r={_prevProps:m({},e)},s=this;function o(K){return!a&&K in e||a&&s.needSyncKeys[K]}var i=null;if(o("treeData")?i=R(e.treeData):o("children")&&(i=e.children),i){r._treeNode=i;var c=V(i);r._keyEntities=c.keyEntities}var y=r._keyEntities||t._keyEntities;if(o("expandedKeys")||a&&o("autoExpandParent")?r._expandedKeys=e.autoExpandParent||!a&&e.defaultExpandParent?P(e.expandedKeys,y):e.expandedKeys:!a&&e.defaultExpandAll?r._expandedKeys=ee(y.keys()):!a&&e.defaultExpandedKeys&&(r._expandedKeys=e.autoExpandParent||e.defaultExpandParent?P(e.defaultExpandedKeys,y):e.defaultExpandedKeys),e.selectable&&(o("selectedKeys")?r._selectedKeys=D(e.selectedKeys,e):!a&&e.defaultSelectedKeys&&(r._selectedKeys=D(e.defaultSelectedKeys,e))),e.checkable){var l;if(o("checkedKeys")?l=O(e.checkedKeys)||{}:!a&&e.defaultCheckedKeys?l=O(e.defaultCheckedKeys)||{}:i&&(l=O(e.checkedKeys)||{checkedKeys:t._checkedKeys,halfCheckedKeys:t._halfCheckedKeys}),l){var h=l,f=h.checkedKeys,v=f===void 0?[]:f,p=h.halfCheckedKeys,x=p===void 0?[]:p;if(!e.checkStrictly){var _=C(v,!0,y);v=_.checkedKeys,x=_.halfCheckedKeys}r._checkedKeys=v,r._halfCheckedKeys=x}}return o("loadedKeys")&&(r._loadedKeys=e.loadedKeys),r},onNodeDragStart:function(e,t){var a=this.$data._expandedKeys,r=t.eventKey,s=G(t);this.dragNode=t,this.setState({_dragNodesKeys:X(typeof s=="function"?s():s,t),_expandedKeys:k(a,r)}),this.__emit("dragstart",{event:e,node:t})},onNodeDragEnter:function(e,t){var a=this,r=this.$data._expandedKeys,s=t.pos,o=t.eventKey;if(!(!this.dragNode||!t.selectHandle)){var i=T(e,t);if(this.dragNode.eventKey===o&&i===0){this.setState({_dragOverNodeKey:"",_dropPosition:null});return}setTimeout(function(){a.setState({_dragOverNodeKey:o,_dropPosition:i}),a.delayedDragEnterLogic||(a.delayedDragEnterLogic={}),Object.keys(a.delayedDragEnterLogic).forEach(function(c){clearTimeout(a.delayedDragEnterLogic[c])}),a.delayedDragEnterLogic[s]=setTimeout(function(){var c=b(r,o);H(a,"expandedKeys")||a.setState({_expandedKeys:c}),a.__emit("dragenter",{event:e,node:t,expandedKeys:c})},400)},0)}},onNodeDragOver:function(e,t){var a=t.eventKey,r=this.$data,s=r._dragOverNodeKey,o=r._dropPosition;if(this.dragNode&&a===s&&t.selectHandle){var i=T(e,t);if(i===o)return;this.setState({_dropPosition:i})}this.__emit("dragover",{event:e,node:t})},onNodeDragLeave:function(e,t){this.setState({_dragOverNodeKey:""}),this.__emit("dragleave",{event:e,node:t})},onNodeDragEnd:function(e,t){this.setState({_dragOverNodeKey:""}),this.__emit("dragend",{event:e,node:t}),this.dragNode=null},onNodeDrop:function(e,t){var a=this.$data,r=a._dragNodesKeys,s=r===void 0?[]:r,o=a._dropPosition,i=t.eventKey,c=t.pos;if(this.setState({_dragOverNodeKey:""}),s.indexOf(i)===-1){var y=q(c),l={event:e,node:t,dragNode:this.dragNode,dragNodesKeys:s.slice(),dropPosition:o+Number(y[y.length-1]),dropToGap:!1};o!==0&&(l.dropToGap=!0),this.__emit("drop",l),this.dragNode=null}},onNodeClick:function(e,t){this.__emit("click",e,t)},onNodeDoubleClick:function(e,t){this.__emit("dblclick",e,t)},onNodeSelect:function(e,t){var a=this.$data._selectedKeys,r=this.$data._keyEntities,s=this.$props.multiple,o=N(t),i=o.selected,c=o.eventKey,y=!i;y?s?a=b(a,c):a=[c]:a=k(a,c);var l=a.map(function(f){var v=r.get(f);return v?v.node:null}).filter(function(f){return f});this.setUncontrolledState({_selectedKeys:a});var h={event:"select",selected:y,node:t,selectedNodes:l,nativeEvent:e};this.__emit("select",a,h)},onNodeCheck:function(e,t,a){var r=this.$data,s=r._keyEntities,o=r._checkedKeys,i=r._halfCheckedKeys,c=this.$props.checkStrictly,y=N(t),l=y.eventKey,h,f={event:"check",node:t,checked:a,nativeEvent:e};if(c){var v=a?b(o,l):k(o,l),p=k(i,l);h={checked:v,halfChecked:p},f.checkedNodes=v.map(function(g){return s.get(g)}).filter(function(g){return g}).map(function(g){return g.node}),this.setUncontrolledState({_checkedKeys:v})}else{var x=C([l],a,s,{checkedKeys:o,halfCheckedKeys:i}),_=x.checkedKeys,K=x.halfCheckedKeys;h=_,f.checkedNodes=[],f.checkedNodesPositions=[],f.halfCheckedKeys=K,_.forEach(function(g){var u=s.get(g);if(!!u){var E=u.node,L=u.pos;f.checkedNodes.push(E),f.checkedNodesPositions.push({node:E,pos:L})}}),this.setUncontrolledState({_checkedKeys:_,_halfCheckedKeys:K})}this.__emit("check",h,f)},onNodeLoad:function(e){var t=this;return new Promise(function(a){t.setState(function(r){var s=r._loadedKeys,o=s===void 0?[]:s,i=r._loadingKeys,c=i===void 0?[]:i,y=t.$props.loadData,l=N(e),h=l.eventKey;if(!y||o.indexOf(h)!==-1||c.indexOf(h)!==-1)return{};var f=y(e);return f.then(function(){var v=t.$data,p=v._loadedKeys,x=v._loadingKeys,_=b(p,h),K=k(x,h);t.__emit("load",_,{event:"load",node:e}),t.setUncontrolledState({_loadedKeys:_}),t.setState({_loadingKeys:K}),a()}),{_loadingKeys:b(c,h)}})})},onNodeExpand:function(e,t){var a=this,r=this.$data._expandedKeys,s=this.$props.loadData,o=N(t),i=o.eventKey,c=o.expanded;r.indexOf(i);var y=!c;if(y?r=b(r,i):r=k(r,i),this.setUncontrolledState({_expandedKeys:r}),this.__emit("expand",r,{node:t,expanded:y,nativeEvent:e}),y&&s){var l=this.onNodeLoad(t);return l?l.then(function(){a.setUncontrolledState({_expandedKeys:r})}):null}return null},onNodeMouseEnter:function(e,t){this.__emit("mouseenter",{event:e,node:t})},onNodeMouseLeave:function(e,t){this.__emit("mouseleave",{event:e,node:t})},onNodeContextMenu:function(e,t){e.preventDefault(),this.__emit("rightClick",{event:e,node:t})},setUncontrolledState:function(e){var t=!1,a={},r=N(this);Object.keys(e).forEach(function(s){s.replace("_","")in r||(t=!0,a[s]=e[s])}),t&&this.setState(a)},registerTreeNode:function(e,t){t?this.domTreeNodes[e]=t:delete this.domTreeNodes[e]},isKeyChecked:function(e){var t=this.$data._checkedKeys,a=t===void 0?[]:t;return a.indexOf(e)!==-1},renderTreeNode:function(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=this.$data,s=r._keyEntities,o=r._expandedKeys,i=o===void 0?[]:o,c=r._selectedKeys,y=c===void 0?[]:c,l=r._halfCheckedKeys,h=l===void 0?[]:l,f=r._loadedKeys,v=f===void 0?[]:f,p=r._loadingKeys,x=p===void 0?[]:p,_=r._dragOverNodeKey,K=r._dropPosition,g=Y(a,t),u=e.key;return!u&&u==null&&(u=g),s.get(u)?W(e,{eventKey:u,expanded:i.indexOf(u)!==-1,selected:y.indexOf(u)!==-1,loaded:v.indexOf(u)!==-1,loading:x.indexOf(u)!==-1,checked:this.isKeyChecked(u),halfChecked:h.indexOf(u)!==-1,pos:g,dragOver:_===u&&K===0,dragOverGapTop:_===u&&K===-1,dragOverGapBottom:_===u&&K===1,key:u}):null}},render:function(){var e=this,t=this.$data._treeNode,a=this.$props,r=a.prefixCls,s=a.focusable,o=a.showLine,i=a.tabindex,c=i===void 0?0:i,y=z(m(m({},this.$props),this.$attrs)),l=this.$attrs,h=l.class,f=l.style;return F("ul",j(j({},y),{},{class:J(r,h,A({},"".concat(r,"-show-line"),o)),style:f,role:"tree",unselectable:"on",tabindex:s?c:null}),[Q(t,function(v,p){return e.renderTreeNode(v,p)})])}});export{oe as T,$ as w};
