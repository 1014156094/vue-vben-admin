var e=Object.assign;import{a2 as t,d as n,r as l,q as s,ao as o,S as i,bm as c,e as a,j as u,bT as r,ab as d,aa as m,H as p,a6 as f,cV as y,cW as h,aq as v}from"./index.899e68b1.js";const b={width:t.number.def(156),customEvent:{type:Object,default:null},styles:t.style,showIcon:t.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}};function x(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!p(e)}const w=e=>{const{item:t}=e;return u("span",{style:"display: inline-block; width: 100%;",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&u(f,{class:"mr-2",icon:t.icon},null),u("span",null,[t.label])])};var j=n({name:"ContextMenu",props:b,setup(t){const n=l(null),p=l(!1),f=s((()=>{const{axis:n,items:l,styles:s,width:o}=t,{x:i,y:c}=n||{x:0,y:0},a=40*(l||[]).length,u=o,r=document.body,d=r.clientWidth<i+u?i-u:i,m=r.clientHeight<c+a?c-a:c;return e(e({},s),{width:`${o}px`,left:`${d+1}px`,top:`${m+1}px`})}));function y(e,t){const{handler:n,disabled:l}=e;l||(p.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function h(e){return e.map((e=>{const{disabled:n,label:l,children:s,divider:o=!1}=e,i=o?u(r,{key:`d-${l}`},null):null;if(!s||0===s.length){let s;return u(d,null,[u(m.Item,{disabled:n,class:"context-menu__item",key:l},x(s=u(w,{showIcon:t.showIcon,item:e,handler:y},null))?s:{default:()=>[s]}),i])}return a(p)?u(m.SubMenu,{key:l,disabled:n,popupClassName:"context-menu__popup"},{title:()=>u(w,{showIcon:t.showIcon,item:e,handler:y},null),default:()=>h(s)}):null}))}return o((()=>{i((()=>p.value=!0))})),c((()=>{const e=a(n);e&&document.body.removeChild(e)})),()=>{let e;const{items:l}=t;return a(p)?u(m,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:n,style:a(f)},x(e=h(l))?e:{default:()=>[e]}):null}}});const E={domList:[],resolve:()=>{}},I=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),y)return new Promise((n=>{const l=document.body,s=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const i=u(j,o);h(i,s);const c=function(){E.resolve("")};E.domList.push(s);const a=function(){E.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",c),l.removeEventListener("scroll",c)};E.resolve=function(...e){a(),n(e[0])},a(),l.appendChild(s),l.addEventListener("click",c),l.addEventListener("scroll",c)}))},L=function(){E&&(E.resolve(""),E.domList=[])};function k(e=!0){return v()&&e&&c((()=>{L()})),[I,L]}export{k as u};