import{x as i}from"./index.39e1fb4c.js";import{d as C,r as h,e as g,o as D,i as N,H as $,b9 as j,j as x,b1 as I}from"./index.de7a3c72.js";var k=C({name:"ImportExcel",emits:["success","error"],setup(l,{emit:s}){const u=h(null),d=h(!1);function p(e){if(!e||!e["!ref"])return[];const t=[],n=i.utils.decode_range(e["!ref"]),o=n.s.r;for(let r=n.s.c;r<=n.e.c;++r){const a=e[i.utils.encode_cell({c:r,r:o})];let f="UNKNOWN "+r;a&&a.t&&(f=i.utils.format_cell(a)),t.push(f)}return t}function m(e){const t=[];for(const n of e.SheetNames){const o=e.Sheets[n],r=p(o),a=i.utils.sheet_to_json(o);t.push({header:r,results:a,meta:{sheetName:n}})}return t}function c(e){return d.value=!0,new Promise((t,n)=>{const o=new FileReader;o.onload=async r=>{try{const a=r.target&&r.target.result,f=i.read(a,{type:"array"}),R=m(f);s("success",R),t("")}catch(a){n(a),s("error")}finally{d.value=!1}},o.readAsArrayBuffer(e)})}async function v(e){const t=g(u);t&&(t.value=""),await c(e)}function w(e){const t=e&&e.target.files,n=t&&t[0];!n||v(n)}function y(){const e=g(u);e&&e.click()}return{handleUpload:y,handleInputClick:w,inputRef:u}}});function S(l,s,u,d,p,m){return D(),N("div",null,[$(x("input",{ref:"inputRef",type:"file",accept:".xlsx, .xls",onChange:s[1]||(s[1]=(...c)=>l.handleInputClick&&l.handleInputClick(...c))},null,544),[[j,!1]]),x("div",{onClick:s[2]||(s[2]=(...c)=>l.handleUpload&&l.handleUpload(...c))},[I(l.$slots,"default")])])}k.render=S;export default k;
