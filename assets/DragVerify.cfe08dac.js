var e=Object.assign;import{u as t,d as s,a as i,r as n,ai as a,b9 as o,q as r,bC as l,e as u,j as c,b7 as d}from"./index.ab86ea0e.js";import{C as f}from"./CheckOutlined.04c29d08.js";import{D as p}from"./DoubleRightOutlined.4fa9f0a9.js";import{u as m}from"./useTimeout.5e8ddc88.js";import{u as g}from"./useExpose.34c51c0a.js";const{t:h}=t(),y={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:[String],default:h("component.verify.dragText")},successText:{type:[String],default:h("component.verify.successText")},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},v=e(e({},y),{src:{type:String},imgWidth:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}});var x=s({name:"BaseDargVerify",props:y,emits:["success","update:value","change","start","move","end"],setup(t,{emit:s,slots:h}){const y=i({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),v=n(null),x=n(null),b=n(null),w=n(null);a((()=>y.isPassing),(e=>{if(e){const{startTime:t,endTime:i}=y;s("success",{isPassing:e,time:((i-t)/1e3).toFixed(1)}),s("update:value",e),s("change",e)}})),o((()=>{y.isPassing=!!t.value}));const S=r((()=>{const{height:s,actionStyle:i}=t,n=`${parseInt(s)}px`;return e({left:0,width:n,height:n},i)})),T=r((()=>{const{height:s,width:i,circle:n,wrapStyle:a}=t,o=parseInt(s),r=`${parseInt(i)}px`;return e({width:r,height:`${o}px`,lineHeight:`${o}px`,borderRadius:n?o/2+"px":0},a)})),D=r((()=>{const{height:s,circle:i,barStyle:n}=t,a=parseInt(s);return e({height:`${a}px`,borderRadius:i?a/2+"px 0 0 "+a/2+"px":0},n)})),j=r((()=>{const{height:s,width:i,contentStyle:n}=t,a=`${parseInt(s)}px`,o=`${parseInt(i)}px`;return e({height:a,width:o},n)}));function M(e){return e.pageX||e.touches[0].pageX}function I(e){if(y.isPassing)return;const t=u(w);t&&(s("start",e),y.moveDistance=M(e)-parseInt(t.style.left.replace("px",""),10),y.startTime=(new Date).getTime(),y.isMoving=!0)}function P(e){const s=parseInt(e.style.width),{width:i}=t,n=parseInt(i);return{offset:n-s-6,widthNum:n,actionWidth:s}}function $(e){const{isMoving:i,moveDistance:n}=y;if(i){const i=u(w),a=u(x);if(!i||!a)return;const{offset:o,widthNum:r,actionWidth:l}=P(i),c=M(e)-n;s("move",{event:e,moveDistance:n,moveX:c}),c>0&&c<=o?(i.style.left=`${c}px`,a.style.width=`${c+l/2}px`):c>o&&(i.style.left=r-l+"px",a.style.width=r-l/2+"px",t.isSlot||O())}}function N(e){const{isMoving:i,isPassing:n,moveDistance:a}=y;if(i&&!n){s("end",e);const i=u(w),n=u(x);if(!i||!n)return;const o=M(e)-a,{offset:r,widthNum:l,actionWidth:c}=P(i);o<r?t.isSlot?setTimeout((()=>{if(t.value){const e=u(b);e&&(e.style.width=`${parseInt(n.style.width)}px`)}else L()}),0):L():(i.style.left=l-c+"px",n.style.width=l-c/2+"px",O()),y.isMoving=!1}}function O(){t.isSlot?L():(y.endTime=(new Date).getTime(),y.isPassing=!0,y.isMoving=!1)}function L(){y.isMoving=!1,y.isPassing=!1,y.moveDistance=0,y.toLeft=!1,y.startTime=0,y.endTime=0;const e=u(w),t=u(x),s=u(b);e&&t&&s&&(y.toLeft=!0,m((()=>{y.toLeft=!1,e.style.left="0",t.style.width="0"}),300),s.style.width=u(j).width)}return l({el:document,name:"mouseup",listener:()=>{y.isMoving&&L()}}),g({resume:L}),()=>c("div",{class:"darg-verify",ref:v,style:u(T),onMousemove:$,onTouchmove:$,onMouseleave:N,onMouseup:N,onTouchend:N},[(()=>{const e=["darg-verify-bar"];return y.toLeft&&e.push("to-left"),c("div",{class:e,ref:x,style:u(D)},null)})(),(()=>{const e=["darg-verify-content"],{isPassing:s}=y,{text:i,successText:n}=t;return s&&e.push("success"),c("div",{class:e,ref:b,style:u(j)},[d(h,"text",s)||(s?n:i)])})(),(()=>{const e=["darg-verify-action"],{toLeft:t,isPassing:s}=y;return t&&e.push("to-left"),c("div",{class:e,onMousedown:I,onTouchstart:I,style:u(S),ref:w},[d(h,"actionIcon",s)||c(s?f:p,{class:"darg-verify-action__icon"},null)])})()])}}),b=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:x});export{x as B,b as D,v as r};