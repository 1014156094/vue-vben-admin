var e=Object.assign;import{aJ as t,d as n,r as s,a1 as l,q as o,E as i,bY as c,e as a,j as r,aR as d,D as u,aN as m,dv as p,dw as f,b3 as v}from"./index.8fd28b0b.js";import{D as y}from"./index.af959341.js";import{M as h}from"./index.e97590c0.js";import"./index.8d91dadc.js";const b={width:t.number.def(156),customEvent:{type:Object,default:null},styles:t.style,showIcon:t.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}};function x(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!u(e)}const w=e=>{const{item:t}=e;return r("span",{style:"display: inline-block; width: 100%;",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&r(m,{class:"mr-2",icon:t.icon},null),r("span",null,[t.label])])};var j=n({name:"ContextMenu",props:b,setup(t){const n=s(null),u=s(!1),m=l((()=>{const{axis:n,items:s,styles:l,width:o}=t,{x:i,y:c}=n||{x:0,y:0},a=40*(s||[]).length,r=o,d=document.body,u=d.clientWidth<i+r?i-r:i,m=d.clientHeight<c+a?c-a:c;return e(e({},l),{width:`${o}px`,left:`${u+1}px`,top:`${m+1}px`})}));function p(e,t){const{handler:n,disabled:s}=e;s||(u.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function f(e){return e.map((e=>{const{disabled:n,label:s,children:l,divider:o=!1}=e,i=o?r(y,{key:`d-${s}`},null):null;if(!l||0===l.length){let l;return r(d,null,[r(h.Item,{disabled:n,class:"context-menu__item",key:s},x(l=r(w,{showIcon:t.showIcon,item:e,handler:p},null))?l:{default:()=>[l]}),i])}return a(u)?r(h.SubMenu,{key:s,disabled:n,popupClassName:"context-menu__popup"},{title:()=>r(w,{showIcon:t.showIcon,item:e,handler:p},null),default:()=>f(l)}):null}))}return o((()=>{i((()=>u.value=!0))})),c((()=>{const e=a(n);e&&document.body.removeChild(e)})),()=>{let e;const{items:s}=t;return a(u)?r(h,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:n,style:a(m)},x(e=f(s))?e:{default:()=>[e]}):null}}});const E={domList:[],resolve:()=>{}},I=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),p)return new Promise((n=>{const s=document.body,l=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const i=r(j,o);f(i,l);const c=function(){E.resolve("")};E.domList.push(l);const a=function(){E.domList.forEach((e=>{try{e&&s.removeChild(e)}catch(t){}})),s.removeEventListener("click",c),s.removeEventListener("scroll",c)};E.resolve=function(...e){a(),n(e[0])},a(),s.appendChild(l),s.addEventListener("click",c),s.addEventListener("scroll",c)}))},L=function(){E&&(E.resolve(""),E.domList=[])};function k(e=!0){return v()&&e&&c((()=>{L()})),[I,L]}export{k as u};