var e=Object.assign;import{a2 as t,d as n,r as l,q as s,aI as o,S as c,bc as i,e as a,j as u,bQ as r,ab as d,aa as m,H as p,a6 as f,cU as y,cV as h,bd as v}from"./index.263e87c1.js";const b={width:t.number.def(156),customEvent:{type:Object,default:null},styles:t.style,showIcon:t.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}};function x(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!p(e)}const w=e=>{const{item:t}=e;return u("span",{style:"display: inline-block; width: 100%;",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&u(f,{class:"mr-2",icon:t.icon},null),u("span",null,[t.label])])};var I=n({name:"ContextMenu",props:b,setup(t){const n=l(null),p=l(!1),f=s((()=>{const{axis:n,items:l,styles:s,width:o}=t,{x:c,y:i}=n||{x:0,y:0},a=40*(l||[]).length,u=o,r=document.body,d=r.clientWidth<c+u?c-u:c,m=r.clientHeight<i+a?i-a:i;return e(e({},s),{width:`${o}px`,left:`${d+1}px`,top:`${m+1}px`})}));function y(e,t){const{handler:n,disabled:l}=e;l||(p.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function h(e){return e.map((e=>{const{disabled:n,label:l,children:s,divider:o=!1}=e,c=o?u(r,{key:`d-${l}`},null):null;if(!s||0===s.length){let s;return u(d,null,[u(m.Item,{disabled:n,class:"context-menu__item",key:l},x(s=u(w,{showIcon:t.showIcon,item:e,handler:y},null))?s:{default:()=>[s]}),c])}return a(p)?u(m.SubMenu,{key:l,disabled:n,popupClassName:"context-menu__popup"},{title:()=>u(w,{showIcon:t.showIcon,item:e,handler:y},null),default:()=>h(s)}):null}))}return o((()=>{c((()=>p.value=!0))})),i((()=>{const e=a(n);e&&document.body.removeChild(e)})),()=>{let e;const{items:l}=t;return a(p)?u(m,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:n,style:a(f)},x(e=h(l))?e:{default:()=>[e]}):null}}});const j={domList:[],resolve:()=>{}},E=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),y)return new Promise((n=>{const l=document.body,s=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const c=u(I,o);h(c,s);const i=function(){j.resolve("")};j.domList.push(s);const a=function(){j.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",i),l.removeEventListener("scroll",i)};j.resolve=function(...e){a(),n(e[0])},a(),l.appendChild(s),l.addEventListener("click",i),l.addEventListener("scroll",i)}))},L=function(){j&&(j.resolve(""),j.domList=[])};function k(e=!0){return v()&&e&&i((()=>{L()})),[E,L]}export{k as u};