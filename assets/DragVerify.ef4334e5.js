var e=Object.assign;import{u as t}from"./useTimeout.81dc2a45.js";import{u as s,d as i,b as n,r as o,a0 as a,a4 as r,s as l,bB as u,f as c,k as d,b1 as f}from"./index.a0c9d414.js";import{u as p}from"./useExpose.9b24ca4e.js";import{C as m}from"./CheckOutlined.1616189b.js";import{D as g}from"./DoubleRightOutlined.1db4fd55.js";const{t:h}=s(),y={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:[String],default:h("component.verify.dragText")},successText:{type:[String],default:h("component.verify.successText")},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},v=e(e({},y),{src:{type:String},imgWidth:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}});var x=i({name:"BaseDargVerify",props:y,emits:["success","update:value","change","start","move","end"],setup(s,{emit:i,slots:h}){const y=n({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),v=o(null),x=o(null),b=o(null),w=o(null);a((()=>y.isPassing),(e=>{if(e){const{startTime:t,endTime:s}=y;i("success",{isPassing:e,time:((s-t)/1e3).toFixed(1)}),i("update:value",e),i("change",e)}})),r((()=>{y.isPassing=!!s.value}));const S=l((()=>{const{height:t,actionStyle:i}=s,n=`${parseInt(t)}px`;return e({left:0,width:n,height:n},i)})),T=l((()=>{const{height:t,width:i,circle:n,wrapStyle:o}=s,a=parseInt(t),r=`${parseInt(i)}px`;return e({width:r,height:`${a}px`,lineHeight:`${a}px`,borderRadius:n?a/2+"px":0},o)})),D=l((()=>{const{height:t,circle:i,barStyle:n}=s,o=parseInt(t);return e({height:`${o}px`,borderRadius:i?o/2+"px 0 0 "+o/2+"px":0},n)})),M=l((()=>{const{height:t,width:i,contentStyle:n}=s,o=`${parseInt(t)}px`,a=`${parseInt(i)}px`;return e({height:o,width:a},n)}));function j(e){return e.pageX||e.touches[0].pageX}function I(e){if(y.isPassing)return;const t=c(w);t&&(i("start",e),y.moveDistance=j(e)-parseInt(t.style.left.replace("px",""),10),y.startTime=(new Date).getTime(),y.isMoving=!0)}function P(e){const t=parseInt(e.style.width),{width:i}=s,n=parseInt(i);return{offset:n-t-6,widthNum:n,actionWidth:t}}function $(e){const{isMoving:t,moveDistance:n}=y;if(t){const t=c(w),o=c(x);if(!t||!o)return;const{offset:a,widthNum:r,actionWidth:l}=P(t),u=j(e)-n;i("move",{event:e,moveDistance:n,moveX:u}),u>0&&u<=a?(t.style.left=`${u}px`,o.style.width=`${u+l/2}px`):u>a&&(t.style.left=r-l+"px",o.style.width=r-l/2+"px",s.isSlot||O())}}function N(e){const{isMoving:t,isPassing:n,moveDistance:o}=y;if(t&&!n){i("end",e);const t=c(w),n=c(x);if(!t||!n)return;const a=j(e)-o,{offset:r,widthNum:l,actionWidth:u}=P(t);a<r?s.isSlot?setTimeout((()=>{if(s.value){const e=c(b);e&&(e.style.width=`${parseInt(n.style.width)}px`)}else B()}),0):B():(t.style.left=l-u+"px",n.style.width=l-u/2+"px",O()),y.isMoving=!1}}function O(){s.isSlot?B():(y.endTime=(new Date).getTime(),y.isPassing=!0,y.isMoving=!1)}function B(){y.isMoving=!1,y.isPassing=!1,y.moveDistance=0,y.toLeft=!1,y.startTime=0,y.endTime=0;const e=c(w),s=c(x),i=c(b);e&&s&&i&&(y.toLeft=!0,t((()=>{y.toLeft=!1,e.style.left="0",s.style.width="0"}),300),i.style.width=c(M).width)}return u({el:document,name:"mouseup",listener:()=>{y.isMoving&&B()}}),p({resume:B}),()=>d("div",{class:"darg-verify",ref:v,style:c(T),onMousemove:$,onTouchmove:$,onMouseleave:N,onMouseup:N,onTouchend:N},[(()=>{const e=["darg-verify-bar"];return y.toLeft&&e.push("to-left"),d("div",{class:e,ref:x,style:c(D)},null)})(),(()=>{const e=["darg-verify-content"],{isPassing:t}=y,{text:i,successText:n}=s;return t&&e.push("success"),d("div",{class:e,ref:b,style:c(M)},[f(h,"text",t)||(t?n:i)])})(),(()=>{const e=["darg-verify-action"],{toLeft:t,isPassing:s}=y;return t&&e.push("to-left"),d("div",{class:e,onMousedown:I,onTouchstart:I,style:c(S),ref:w},[f(h,"actionIcon",s)||d(s?m:g,{class:"darg-verify-action__icon"},null)])})()])}}),b=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:x});export{x as B,b as D,v as r};