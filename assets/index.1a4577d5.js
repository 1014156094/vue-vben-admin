var e=Object.assign;import{k as n,y as t,z as l,u as o,D as a,a4 as s,f as r,d as i,X as c,c2 as u,bO as d,c3 as f,a2 as p,a3 as g,bc as m,r as h,s as b,a0 as v,a6 as C,b5 as y,a7 as O,i as F,aN as k,o as S,j as H,w as M,ak as w,aa as P,N as x,Q as j,l as $,n as W,m as T,ap as B,bG as R,a1 as A,a9 as E,c0 as N,aK as L,S as _,b as I,c4 as V,c5 as z,bI as q,t as D,b$ as X,b9 as Y,b7 as G}from"./index.94b82568.js";import{u as K}from"./useTimeout.b50e2d3d.js";import{u as Q}from"./useAttrs.a8ca5768.js";import{u as J}from"./useWindowSizeFn.f0ff55fc.js";import{_ as U,d as Z}from"./index.17280903.js";import{F as ee,a as ne}from"./FullscreenOutlined.ea907300.js";var te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};function le(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var oe=function(e,o){var a=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?Object(arguments[n]):{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),l.forEach((function(n){le(e,n,t[n])}))}return e}({},e,o.attrs);return n(l,t(a,{icon:te}),null)};oe.displayName="CloseOutlined",oe.inheritAttrs=!1;const{t:ae}=o(),se={visible:a.bool,height:a.number,minHeight:a.number,draggable:a.bool.def(!0),centered:a.bool,cancelText:a.string.def(ae("common.cancelText")),okText:a.string.def(ae("common.okText")),closeFunc:Function},re=Object.assign({},se,{defaultFullscreen:a.bool,canFullscreen:a.bool.def(!0),wrapperFooterOffset:a.number.def(0),helpMessage:[String,Array],useWrapper:a.bool.def(!0),loading:a.bool,loadingTip:a.string,showCancelBtn:a.bool.def(!0),showOkBtn:a.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:a.bool.def(!0),closeIcon:Object,confirmLoading:a.bool,destroyOnClose:a.bool,footer:Object,getContainer:Function,mask:a.bool.def(!0),maskClosable:a.bool.def(!0),keyboard:a.bool.def(!0),maskStyle:Object,okType:a.string.def("primary"),okButtonProps:Object,cancelButtonProps:Object,title:a.string,visible:a.bool,width:[String,Number],wrapClassName:a.string,zIndex:a.number});function ie(e){const n=(e,n)=>getComputedStyle(e)[n],t=t=>{if(!t)return;t.setAttribute("data-drag",r(e.draggable));const l=t.querySelector(".ant-modal-header"),o=t.querySelector(".ant-modal");l&&o&&r(e.draggable)&&(l.style.cursor="move",l.onmousedown=e=>{if(!e)return;const t=e.clientX,l=e.clientY,a=document.body.clientWidth,s=document.documentElement.clientHeight,r=o.offsetWidth,i=o.offsetHeight,c=o.offsetLeft,u=a-o.offsetLeft-r,d=o.offsetTop,f=s-o.offsetTop-i,p=n(o,"left"),g=n(o,"top");let m=+p,h=+g;p.includes("%")?(m=+document.body.clientWidth*(+p.replace(/%/g,"")/100),h=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(m=+p.replace(/px/g,""),h=+g.replace(/px/g,"")),document.onmousemove=function(e){let n=e.clientX-t,a=e.clientY-l;-n>c?n=-c:n>u&&(n=u),-a>d?a=-d:a>f&&(a=f),o.style.cssText+=`;left:${n+m}px;top:${a+h}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};s((()=>{r(e.visible)&&r(e.draggable)&&K((()=>{(()=>{const l=document.querySelectorAll(".ant-modal-wrap");for(const o of Array.from(l)){if(!o)continue;const l=n(o,"display"),a=o.getAttribute("data-drag");"none"!==l&&(null===a||r(e.destroyOnClose))&&t(o)}})()}),30)}))}var ce=i({name:"Modal",inheritAttrs:!1,props:re,setup(t,{slots:l}){const{visible:o,draggable:a,destroyOnClose:s}=c(t),i=Q();return ie({visible:o,destroyOnClose:s,draggable:a}),()=>{let o;const a=e(e({},r(i)),t);return n(f,a,"function"==typeof(s=o=u(l))||"[object Object]"===Object.prototype.toString.call(s)&&!d(s)?o:{default:()=>[o]});var s}}});const ue=Symbol();function de(){return g(ue)}var fe=i({name:"ModalWrapper",inheritAttrs:!1,components:{Spin:m,ScrollContainer:U},props:{loading:a.bool,useWrapper:a.bool.def(!0),modalHeaderHeight:a.number.def(57),modalFooterHeight:a.number.def(74),minHeight:a.number.def(200),height:a.number,footerOffset:a.number.def(0),visible:a.bool,fullScreen:a.bool,loadingTip:a.string},emits:["height-change","ext-height"],setup(e,{emit:n}){const t=h(null),l=h(null),o=h(0),a=h(0);let i=0;J(u),p({redoModalHeight:u},ue);const c=b((()=>({minHeight:`${e.minHeight}px`,height:`${r(o)}px`})));async function u(){if(!e.visible)return;const a=r(t);if(!a)return;const s=a.$el.parentElement;if(s){s.style.padding="0",await O();try{const t=s.parentElement&&s.parentElement.parentElement;if(!t)return;const a=getComputedStyle(t).top,c=Number.parseInt(a);let u=window.innerHeight-2*c+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;c<40&&(u-=26),await O();const d=r(l);if(!d)return;await O(),i=d.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:i>u?u:i,n("height-change",r(o))}catch(c){}}}return s((()=>{e.useWrapper&&u()})),v((()=>e.fullScreen),(e=>{u(),e?a.value=o.value:o.value=a.value})),C((()=>{const{modalHeaderHeight:t,modalFooterHeight:l}=e;n("ext-height",t+l)})),y((()=>{})),{wrapperRef:t,spinRef:l,spinStyle:c}}});fe.render=function(e,t,l,o,a,s){const r=F("ScrollContainer"),i=k("loading");return S(),H(r,{ref:"wrapperRef"},{default:M((()=>[w(n("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[P(e.$slots,"default")],12,["loading-tip"]),[[i,e.loading]])])),_:3},512)};var pe=i({name:"ModalClose",components:{FullscreenExitOutlined:ee,FullscreenOutlined:ne,CloseOutlined:oe},props:{canFullscreen:a.bool.def(!0),fullScreen:a.bool},emits:["cancel","fullscreen"],setup(e,{emit:n}){const{prefixCls:t}=x("basic-modal-close");return{getClass:b((()=>[t,`${t}--custom`,{[`${t}--can-full`]:e.canFullscreen}])),prefixCls:t,handleCancel:function(){n("cancel")},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),n("fullscreen")}}}});pe.render=function(e,t,l,o,a,s){const r=F("FullscreenExitOutlined"),i=F("FullscreenOutlined"),c=F("CloseOutlined");return S(),H("div",{class:e.getClass},[e.canFullscreen?(S(),H(j,{key:0},[e.fullScreen?(S(),H(r,{key:0,role:"full",onClick:e.handleFullScreen},null,8,["onClick"])):(S(),H(i,{key:1,role:"close",onClick:e.handleFullScreen},null,8,["onClick"]))],64)):$("",!0),n(c,{onClick:e.handleCancel},null,8,["onClick"])],2)};var ge=i({name:"BasicModalFooter",props:re,emits:["ok","cancel"],setup:(e,{emit:n})=>({handleOk:function(){n("ok")},handleCancel:function(){n("cancel")}})});ge.render=function(e,n,l,o,a,s){const r=F("a-button");return S(),H("div",null,[P(e.$slots,"insertFooter"),e.showCancelBtn?(S(),H(r,t({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:M((()=>[W(T(e.cancelText),1)])),_:1},16,["onClick"])):$("",!0),P(e.$slots,"centerFooter"),e.showOkBtn?(S(),H(r,t({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:M((()=>[W(T(e.okText),1)])),_:1},16,["type","onClick","loading"])):$("",!0),P(e.$slots,"appendFooter")])};var me=i({name:"BasicModalHeader",components:{BasicTitle:Z},props:{helpMessage:{type:[String,Array]},title:a.string}});me.render=function(e,n,t,l,o,a){const s=F("BasicTitle");return S(),H(s,{helpMessage:e.helpMessage},{default:M((()=>[W(T(e.title),1)])),_:1},8,["helpMessage"])};var he=i({name:"BasicModal",inheritAttrs:!1,components:{Modal:ce,ModalWrapper:fe,ModalClose:pe,ModalFooter:ge,ModalHeader:me},props:re,emits:["visible-change","height-change","cancel","ok","register"],setup(n,{emit:t,attrs:l}){const o=h(!1),a=h(null),i=h(null),c=h(0),u={setModalProps:function(e){if(a.value=N(r(a)||{},e),!Reflect.has(e,"visible"))return;o.value=!!e.visible},emitVisible:void 0},d=E();d&&t("register",u,d.uid);const f=b((()=>e(e({},n),r(a)))),{handleFullScreen:p,getWrapClassName:g,fullScreenRef:m}=function(e){const n=h(!1);return{getWrapClassName:b((()=>{const t=r(e.wrapClassName)||"";return r(n)?`fullscreen-modal ${t} `:r(t)})),handleFullScreen:function(e){e&&e.stopPropagation(),n.value=!r(n)},fullScreenRef:n}}({modalWrapperRef:i,extHeightRef:c,wrapClassName:B(f.value,"wrapClassName")}),C=b((()=>{const n=e(e({},r(f)),{visible:r(o),title:void 0});return e(e({},n),{wrapClassName:r(g)})})),y=b((()=>e(e({},l),r(C))));return s((()=>{o.value=!!n.visible,m.value=!!n.defaultFullscreen})),v((()=>r(o)),(e=>{var n;t("visible-change",e),d&&(null==(n=u.emitVisible)||n.call(u,e,d.uid))}),{immediate:!1}),{handleCancel:async function(e){if(null==e||e.stopPropagation(),n.closeFunc&&A(n.closeFunc)){const e=await n.closeFunc();o.value=!e}else o.value=!1,t("cancel")},getBindValue:y,getProps:C,handleFullScreen:p,fullScreenRef:m,getMergeProps:f,handleOk:function(){t("ok")},visibleRef:o,omit:R,modalWrapperRef:i,handleExtHeight:function(e){c.value=e},handleHeightChange:function(e){t("height-change",e)}}}});he.render=function(e,l,o,a,s,r){const i=F("ModalClose"),c=F("ModalHeader"),u=F("ModalFooter"),d=F("ModalWrapper"),f=F("Modal");return S(),H(f,t({onCancel:e.handleCancel},e.getBindValue),L({default:M((()=>[n(d,t({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,minHeight:e.getProps.minHeight,height:e.getProps.height,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:M((()=>[P(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:M((()=>[n(i,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:M((()=>[n(c,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title},null,8,["helpMessage","title"])]))},e.$slots.footer?void 0:{name:"footer",fn:M((()=>[n(u,t(e.getProps,{onOk:e.handleOk,onCancel:e.handleCancel}),L({_:2},[_(Object.keys(e.$slots),(n=>({name:n,fn:M((t=>[P(e.$slots,n,t)]))})))]),1040,["onOk","onCancel"])]))},_(Object.keys(e.omit(e.$slots,"default")),(n=>({name:n,fn:M((t=>[P(e.$slots,n,t)]))})))]),1040,["onCancel"])};const be=I({}),ve=I({});function Ce(){V();const e=h(null),n=h(!1),t=h("");const l=()=>{const n=r(e);return n||X("useModal instance is undefined!"),n};return[function(l,o){t.value=o,y((()=>{e.value=null,n.value=!1,be[r(t)]=null})),r(n)&&z()&&l===r(e)||(e.value=l,l.emitVisible=(e,n)=>{ve[n]=e})},{setModalProps:e=>{var n;null==(n=l())||n.setModalProps(e)},getVisible:b((()=>ve[~~r(t)])),openModal:(e=!0,n,o=!0)=>{var a;if(null==(a=l())||a.setModalProps({visible:e}),!n)return;if(o)return be[r(t)]=null,void(be[r(t)]=n);q(D(be[r(t)]),n)||(be[r(t)]=n)}}]}const ye=e=>{const n=h(null),t=E(),l=h(""),o=()=>{const e=r(n);return e||X("useModalInner instance is undefined!"),e};return s((()=>{const n=be[r(l)];n&&e&&A(e)&&O((()=>{e(n)}))})),[(e,o)=>{Y((()=>{n.value=null})),l.value=o,n.value=e,null==t||t.emit("register",e,o)},{changeLoading:(e=!0)=>{var n;null==(n=o())||n.setModalProps({loading:e})},getVisible:b((()=>ve[~~r(l)])),changeOkLoading:(e=!0)=>{var n;null==(n=o())||n.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=o())||e.setModalProps({visible:!1})},setModalProps:e=>{var n;null==(n=o())||n.setModalProps(e)}}]};G(he);export{oe as C,he as _,ye as a,Ce as b,de as u};