import{u as e,T as t,f as o,a as n,_ as l,O as r,dn as a,r as s,p as i,M as c,N as u,bO as f,aV as d,D as p,bY as m,dv as g,a8 as b,az as h,c1 as y}from"./index.a4c995c9.js";import"./xlsx.a48e520c.js";import{C as v}from"./CloseOutlined.6993095c.js";import{F as x,a as H}from"./FullscreenOutlined.af1017f1.js";import"./useContext.1c84e748.js";import{u as C}from"./useTimeout.0fb9d179.js";import{u as w}from"./useDebounce.460c0b67.js";import{b as F}from"./index.b191181c.js";import{e as S,g as j}from"./tsxHelper.20d71045.js";import"./index.85a2c56f.js";import{p as O}from"./propTypes.7f710850.js";import{s as k}from"./index.2e04fe2b.js";import{c as B}from"./useModalContext.e5c00ab2.js";import{u as T}from"./useWindowSizeFn.bee853aa.js";import{a as N,r as W}from"./resizeEvent.70875b52.js";const{t:M}=e(),$={visible:O.bool,draggable:O.bool.def(!0),centered:O.bool,cancelText:O.string.def(M("component.modal.cancelText")),okText:O.string.def(M("component.modal.okText")),closeFunc:Function},E=Object.assign({},$,{canFullscreen:O.bool.def(!0),wrapperFooterOffset:O.number.def(0),helpMessage:[String,Array],useWrapper:O.bool.def(!0),loading:O.bool,showCancelBtn:O.bool.def(!0),showOkBtn:O.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:Boolean,destroyOnClose:Boolean,footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:Boolean,width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function P(e){const n=(e,t)=>getComputedStyle(e)[t],l=t=>{if(!t)return;t.setAttribute("data-drag",o(e.draggable));const l=t.querySelector(".ant-modal-header"),r=t.querySelector(".ant-modal");l&&r&&o(e.draggable)&&(l.style.cursor="move",l.onmousedown=e=>{if(!e)return;const t=e.clientX,o=e.clientY,l=document.body.clientWidth,a=document.documentElement.clientHeight,s=r.offsetWidth,i=r.offsetHeight,c=r.offsetLeft,u=l-r.offsetLeft-s,f=r.offsetTop,d=a-r.offsetTop-i,p=n(r,"left"),m=n(r,"top");let g=+p,b=+m;p.includes("%")?(g=+document.body.clientWidth*(+p.replace(/%/g,"")/100),b=+document.body.clientHeight*(+m.replace(/%/g,"")/100)):(g=+p.replace(/px/g,""),b=+m.replace(/px/g,"")),document.onmousemove=function(e){let n=e.clientX-t,l=e.clientY-o;-n>c?n=-c:n>u&&(n=u),-l>f?l=-f:l>d&&(l=d),r.style.cssText+=`;left:${n+g}px;top:${l+b}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};t((()=>{o(e.visible)&&o(e.draggable)&&C((()=>{(()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const r of Array.from(t)){if(!r)continue;const t=n(r,"display"),a=r.getAttribute("data-drag");"none"!==t&&(null===a||o(e.destroyOnClose))&&l(r)}})()}),30)}))}var R=n({name:"Modal",inheritAttrs:!1,props:E,setup(e,{attrs:t,slots:o}){const{visible:n,draggable:s,destroyOnClose:i}=l(e);return P({visible:n,destroyOnClose:i,draggable:s}),()=>{const n={...t,...e};return r(a,{...n},S(o))}}});var q=n({name:"ModalWrapper",props:{loading:O.bool,modalHeaderHeight:O.number.def(50),modalFooterHeight:O.number.def(54),minHeight:O.number.def(200),footerOffset:O.number.def(0),visible:O.bool,fullScreen:O.bool},emits:["heightChange","getExtHeight"],setup(e,{slots:n,emit:l}){const a=s(null),m=s(null),g=s(0);let b=()=>{};T(y),B({redoModalHeight:y});const h=i((()=>({minHeight:`${e.minHeight}px`,height:`${o(g)}px`,overflow:"auto"})));async function y(){if(!e.visible)return;const t=o(a);if(!t)return;const n=t.parentElement;if(n){n.style.padding="0",await p();try{const t=n.parentElement&&n.parentElement.parentElement;if(!t)return;const r=getComputedStyle(t).top,a=Number.parseInt(r);let s=window.innerHeight-2*a+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;a<40&&(s-=26),await p();const i=o(m);if(!i)return;const c=i.$el.querySelector(".ant-spin-container");if(!c)return;const u=c.scrollHeight;e.fullScreen?g.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight:g.value=u>s?s:u+16+30,l("heightChange",o(g)),p((()=>{const e=i.$el;e&&(e.style.height=`${o(g)}px`)}))}catch(e){}}}return t((()=>{y()})),c((()=>e.fullScreen),(e=>{!e&&y()})),u((()=>{const{modalHeaderHeight:t,modalFooterHeight:n}=e;l("getExtHeight",t+n),function(){const e=o(a);if(!e)return;const t=e.querySelector(".ant-spin-container");if(!t)return;const[n,l]=function(e,t,o=100,n){let l=()=>{t()};const[r,a]=w(l,o,n);return l=o?r:l,[function(){N(e,l)},function(){W(e,l),a()}]}(t,(()=>{y()}));b=l,n()}()})),f((()=>{b&&b()})),()=>r("div",{ref:a,style:o(h)},r(d,{ref:m,spinning:e.loading},(()=>j(n))))}});var A=n({name:"BasicModal",props:E,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{slots:n,emit:l,attrs:a}){const u=s(!1),f=s(null),d=s(null),p=s(0),C=i((()=>({...e,...o(f)}))),{handleFullScreen:w,getWrapClassName:O,fullScreenRef:B}=function(e){const t=s(0),n=s(!1);return{getWrapClassName:i((()=>{const t=o(e.wrapClassName)||"";return o(n)?`fullscreen-modal ${t} `:o(t)})),handleFullScreen:function(l){l&&l.stopPropagation(),n.value=!o(n);const r=o(e.modalWrapperRef);if(!r)return;const a=r.$el;if(!a)return;const s=a.querySelector(".ant-spin-nested-loading");s&&(!o(t)&&o(n)&&(t.value=s.offsetHeight),o(n)?s.style.height=window.innerHeight-o(e.extHeightRef)+"px":s.style.height=`${o(t)}px`)},fullScreenRef:n}}({modalWrapperRef:d,extHeightRef:p,wrapClassName:m(C.value,"wrapClassName")}),T=i((()=>({...{...o(C),visible:o(u),title:void 0},wrapClassName:o(O)}))),N=i((()=>({...a,...o(T)})));async function W(t){if(null==t||t.stopPropagation(),e.closeFunc&&h(e.closeFunc)){const t=await e.closeFunc();u.value=!t}else u.value=!1,l("cancel")}t((()=>{u.value=!!e.visible})),c((()=>o(u)),(e=>{l("visible-change",e)}),{immediate:!1});const M={setModalProps:function(e){f.value=y(o(f)||{},e),Reflect.has(e,"visible")&&(u.value=!!e.visible)}};return g((e=>{l("register",M,e.uid)})),()=>r(R,{onCancel:W,...o(N)},{footer:()=>function(){const{showCancelBtn:e,cancelButtonProps:t,cancelText:a,showOkBtn:s,okType:i,okText:c,okButtonProps:u,confirmLoading:f}=o(T);return r(b,null,j(n,"insertFooter"),e&&r(k,{...t,onClick:W},(()=>a)),j(n,"centerdFooter"),s&&r(k,{type:i,loading:f,onClick:()=>{l("ok")},...u},(()=>c)),j(n,"appendFooter"))}(),closeIcon:()=>function(){const{canFullscreen:e}=o(T),t=o(B)?r(x,{role:"full",onClick:w}):r(H,{role:"close",onClick:w});return r("div",{class:["custom-close-icon",{"can-full":e}]},e&&t,r(v,{onClick:W}))}(),title:()=>function(){const{helpMessage:e}=o(T),{title:t}=o(C);return r(F,{helpMessage:e},(()=>n.title?j(n,"title"):t))}(),...S(n,["default"]),default:()=>function(){const{useWrapper:t,loading:a,wrapperProps:s}=o(T);if(!t)return j(n);const i=void 0===e.footer||e.footer?void 0:0;return r(q,{footerOffset:e.wrapperFooterOffset,fullScreen:o(B),ref:d,loading:a,visible:o(u),modalFooterHeight:i,...s,onGetExtHeight:e=>{p.value=e},onHeightChange:e=>{l("height-change",e)}},(()=>j(n)))}()})}});export default A;