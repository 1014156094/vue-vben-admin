import{u as e,H as l,aM as n,f as t,a as o,aG as a,ay as s,bw as r,bW as i,bV as c,cl as u,r as d,I as p,a$ as f,X as g,cU as m,R as h,i as b,br as v,o as C,j as y,w as F,ap as k,k as H,K as M,aU as S,aL as O,m as w,J as x,p as P,n as j,b4 as W,Z as $,cK as R,dk as T,bp as B,aV as E,b as N,dm as A,dn as V,cN as L,t as I,dj as _,cX as X,N as q}from"./index.e76c06f1.js";import{o as z}from"./omit.387e4bc9.js";import{s as K,c as U}from"./index.1ef513c1.js";import{C as Y}from"./CloseOutlined.364204b4.js";import{F as D,a as G}from"./FullscreenOutlined.647cd1c9.js";import{u as J}from"./useTimeout.0b9d202d.js";import{e as Z}from"./tsxHelper.3ee1ad98.js";import{u as Q}from"./useAttrs.cd179906.js";import{u as ee}from"./useWindowSizeFn.18768138.js";const{t:le}=e(),ne={visible:l.bool,height:l.number,minHeight:l.number,draggable:l.bool.def(!0),centered:l.bool,cancelText:l.string.def(le("component.modal.cancelText")),okText:l.string.def(le("component.modal.okText")),closeFunc:Function},te=Object.assign({},ne,{canFullscreen:l.bool.def(!0),wrapperFooterOffset:l.number.def(0),helpMessage:[String,Array],useWrapper:l.bool.def(!0),loading:l.bool,loadingTip:l.string,showCancelBtn:l.bool.def(!0),showOkBtn:l.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:l.bool.def(!0),closeIcon:Object,confirmLoading:l.bool,destroyOnClose:l.bool,footer:Object,getContainer:Function,mask:l.bool.def(!0),maskClosable:l.bool.def(!0),keyboard:l.bool.def(!0),maskStyle:Object,okType:l.string.def("primary"),okButtonProps:Object,cancelButtonProps:Object,title:l.string,visible:l.bool,width:[String,Number],wrapClassName:l.string,zIndex:l.number});function oe(e){const l=(e,l)=>getComputedStyle(e)[l],o=n=>{if(!n)return;n.setAttribute("data-drag",t(e.draggable));const o=n.querySelector(".ant-modal-header"),a=n.querySelector(".ant-modal");o&&a&&t(e.draggable)&&(o.style.cursor="move",o.onmousedown=e=>{if(!e)return;const n=e.clientX,t=e.clientY,o=document.body.clientWidth,s=document.documentElement.clientHeight,r=a.offsetWidth,i=a.offsetHeight,c=a.offsetLeft,u=o-a.offsetLeft-r,d=a.offsetTop,p=s-a.offsetTop-i,f=l(a,"left"),g=l(a,"top");let m=+f,h=+g;f.includes("%")?(m=+document.body.clientWidth*(+f.replace(/%/g,"")/100),h=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(m=+f.replace(/px/g,""),h=+g.replace(/px/g,"")),document.onmousemove=function(e){let l=e.clientX-n,o=e.clientY-t;-l>c?l=-c:l>u&&(l=u),-o>d?o=-d:o>p&&(o=p),a.style.cssText+=`;left:${l+m}px;top:${o+h}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};n((()=>{t(e.visible)&&t(e.draggable)&&J((()=>{(()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const a of Array.from(n)){if(!a)continue;const n=l(a,"display"),s=a.getAttribute("data-drag");"none"!==n&&(null===s||t(e.destroyOnClose))&&o(a)}})()}),30)}))}var ae=o({name:"Modal",inheritAttrs:!1,props:te,setup(e,{slots:l}){const{visible:n,draggable:o,destroyOnClose:i}=a(e),c=Q();return oe({visible:n,destroyOnClose:i,draggable:o}),()=>{const n={...t(c),...e};return s(r,{...n},Z(l))}}});const se=Symbol();function re(){return c(se)}var ie=o({name:"ModalWrapper",inheritAttrs:!1,components:{Spin:u,ScrollContainer:K},props:{loading:l.bool,useWrapper:l.bool.def(!0),modalHeaderHeight:l.number.def(50),modalFooterHeight:l.number.def(54),minHeight:l.number.def(200),height:l.number,footerOffset:l.number.def(0),visible:l.bool,fullScreen:l.bool,loadingTip:l.string},emits:["height-change","ext-height"],setup(e,{emit:l}){const o=d(null),a=d(null),s=d(0),r=d(0);let c=0;ee(v),i({redoModalHeight:v},se);const u=p((()=>({minHeight:`${e.minHeight}px`,height:`${t(s)}px`}))),b=p((()=>({height:t(s)-28+"px"})));async function v(){if(!e.visible)return;const n=t(o);if(!n)return;const r=n.$el.parentElement;if(r){r.style.padding="0",await h();try{const n=r.parentElement&&r.parentElement.parentElement;if(!n)return;const o=getComputedStyle(n).top,i=Number.parseInt(o);let u=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(u-=26),await h();const d=t(a);if(!d)return;c||(c=d.scrollHeight),e.fullScreen?s.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight:s.value=e.height?e.height:c>u?u:c+46,l("height-change",t(s))}catch(e){}}}return n((()=>{e.useWrapper&&v()})),f((()=>e.fullScreen),(e=>{v(),e?r.value=s.value:s.value=r.value})),g((()=>{const{modalHeaderHeight:n,modalFooterHeight:t}=e;l("ext-height",n+t)})),m((()=>{})),{wrapStyle:u,wrapperRef:o,spinRef:a,spinStyle:b}}});ie.render=function(e,l,n,t,o,a){const s=b("ScrollContainer"),r=v("loading");return C(),y(s,{ref:"wrapperRef",style:e.wrapStyle},{default:F((()=>[k(H("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[M(e.$slots,"default")],12,["loading-tip"]),[[r,e.loading]])])),_:3},8,["style"])};var ce=o({name:"ModalClose",components:{FullscreenExitOutlined:D,FullscreenOutlined:G,CloseOutlined:Y},props:{canFullscreen:l.bool.def(!0),fullScreen:l.bool},emits:["cancel","fullscreen"],setup(e,{emit:l}){const{prefixCls:n}=S("basic-modal-close");return{getClass:p((()=>[n,`${n}--custom`,{[`${n}--can-full`]:e.canFullscreen}])),prefixCls:n,handleCancel:function(){l("cancel")},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),l("fullscreen")}}}});ce.render=function(e,l,n,t,o,a){const s=b("FullscreenExitOutlined"),r=b("FullscreenOutlined"),i=b("CloseOutlined");return C(),y("div",{class:e.getClass},[e.canFullscreen?(C(),y(O,{key:0},[e.fullScreen?(C(),y(s,{key:0,role:"full",onClick:e.handleFullScreen},null,8,["onClick"])):(C(),y(r,{key:1,role:"close",onClick:e.handleFullScreen},null,8,["onClick"]))],64)):w("v-if",!0),H(i,{onClick:e.handleCancel},null,8,["onClick"])],2)};var ue=o({name:"BasicModalFooter",props:te,emits:["ok","cancel"],setup:(e,{emit:l})=>({handleOk:function(){l("ok")},handleCancel:function(){l("cancel")}})});ue.render=function(e,l,n,t,o,a){const s=b("a-button");return C(),y("div",null,[M(e.$slots,"insertFooter"),e.showCancelBtn?(C(),y(s,x({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:F((()=>[P(j(e.cancelText),1)])),_:1},16,["onClick"])):w("v-if",!0),M(e.$slots,"centerFooter"),e.showOkBtn?(C(),y(s,x({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:F((()=>[P(j(e.okText),1)])),_:1},16,["type","onClick","loading"])):w("v-if",!0),M(e.$slots,"appendFooter")])};var de=o({name:"BasicModalHeader",components:{BasicTitle:U},props:{helpMessage:{type:[String,Array]},title:l.string}});de.render=function(e,l,n,t,o,a){const s=b("BasicTitle");return C(),y(s,{helpMessage:e.helpMessage},{default:F((()=>[P(j(e.title),1)])),_:1},8,["helpMessage"])};var pe=o({name:"BasicModal",inheritAttrs:!1,components:{Modal:ae,ModalWrapper:ie,ModalClose:ce,ModalFooter:ue,ModalHeader:de},props:te,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{emit:l,attrs:o}){const a=d(!1),s=d(null),r=d(null),i=d(0),c={setModalProps:function(e){if(s.value=T(t(s)||{},e),!Reflect.has(e,"visible"))return;a.value=!!e.visible},emitVisible:void 0},u=R();u&&l("register",c,u.uid);const g=p((()=>({...e,...t(s)}))),{handleFullScreen:m,getWrapClassName:h,fullScreenRef:b}=function(e){const l=d(!1);return{getWrapClassName:p((()=>{const n=t(e.wrapClassName)||"";return t(l)?`fullscreen-modal ${n} `:t(n)})),handleFullScreen:function(e){e&&e.stopPropagation(),l.value=!t(l)},fullScreenRef:l}}({modalWrapperRef:r,extHeightRef:i,wrapClassName:W(g.value,"wrapClassName")}),v=p((()=>({...{...t(g),visible:t(a),title:void 0},wrapClassName:t(h)}))),C=p((()=>({...o,...t(v)})));return n((()=>{a.value=!!e.visible})),f((()=>t(a)),(e=>{var n;l("visible-change",e),u&&(null==(n=c.emitVisible)||n.call(c,e,u.uid))}),{immediate:!1}),{handleCancel:async function(n){if(null==n||n.stopPropagation(),e.closeFunc&&$(e.closeFunc)){const l=await e.closeFunc();a.value=!l}else a.value=!1,l("cancel")},getBindValue:C,getProps:v,handleFullScreen:m,fullScreenRef:b,getMergeProps:g,handleOk:function(){l("ok")},visibleRef:a,omit:z,modalWrapperRef:r,handleExtHeight:function(e){i.value=e},handleHeightChange:function(e){l("height-change",e)}}}});pe.render=function(e,l,n,t,o,a){const s=b("ModalClose"),r=b("ModalHeader"),i=b("ModalFooter"),c=b("ModalWrapper"),u=b("Modal");return C(),y(u,x({onCancel:e.handleCancel},e.getBindValue),B({default:F((()=>[H(c,x({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,minHeight:e.getProps.minHeight,height:e.getProps.height,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:F((()=>[M(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:F((()=>[H(s,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:F((()=>[H(r,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title},null,8,["helpMessage","title"])]))},e.$slots.footer?void 0:{name:"footer",fn:F((()=>[H(i,x(e.getProps,{onOk:e.handleOk,onCancel:e.handleCancel}),null,16,["onOk","onCancel"])]))},E(Object.keys(e.omit(e.$slots,"default")),(l=>({name:l,fn:F((n=>[M(e.$slots,l,n)]))})))]),1040,["onCancel"])};const fe=N({}),ge=N({});function me(){A();const e=d(null),l=d(!1),n=d("");const o=()=>{const l=t(e);return l||_("useModal instance is undefined!"),l};return[function(o,a){n.value=a,m((()=>{e.value=null,l.value=!1,fe[t(n)]=null})),t(l)&&V()&&o===t(e)||(e.value=o,o.emitVisible=(e,l)=>{ge[l]=e})},{setModalProps:e=>{var l;null==(l=o())||l.setModalProps(e)},getVisible:p((()=>ge[~~t(n)])),openModal:(e=!0,l,a=!0)=>{var s;if(null==(s=o())||s.setModalProps({visible:e}),!l)return;if(a)return fe[t(n)]=null,void(fe[t(n)]=l);L(I(fe[t(n)]),l)||(fe[t(n)]=l)}}]}const he=e=>{const l=d(null),o=R(),a=d(""),s=()=>{const e=t(l);return e||_("useModalInner instance is undefined!"),e};return n((()=>{const l=fe[t(a)];l&&e&&$(e)&&h((()=>{e(l)}))})),[(e,n)=>{X((()=>{l.value=null})),a.value=n,l.value=e,null==o||o.emit("register",e,n)},{changeLoading:(e=!0)=>{var l;null==(l=s())||l.setModalProps({loading:e})},getVisible:p((()=>ge[~~t(a)])),changeOkLoading:(e=!0)=>{var l;null==(l=s())||l.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=s())||e.setModalProps({visible:!1})},setModalProps:e=>{var l;null==(l=s())||l.setModalProps(e)}}]};q(pe);export{me as a,re as b,pe as s,he as u};