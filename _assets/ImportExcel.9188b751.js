import{a as e,r as t,f as n,o as s,j as a,ap as r,aq as l,k as o,K as c}from"./index.ed640425.js";import{x as u}from"./xlsx.a48e520c.js";var i=e({name:"ImportExcel",emits:["success","error"],setup(e,{emit:s}){const a=t(null),r=t(!1);function l(e){if(!e||!e["!ref"])return[];const t=[],n=u.utils.decode_range(e["!ref"]),s=n.s.r;for(let a=n.s.c;a<=n.e.c;++a){const n=e[u.utils.encode_cell({c:a,r:s})];let r="UNKNOWN "+a;n&&n.t&&(r=u.utils.format_cell(n)),t.push(r)}return t}function o(e){return r.value=!0,new Promise(((t,n)=>{const a=new FileReader;a.onload=async e=>{try{const n=e.target&&e.target.result,a=function(e){const t=[];for(const n of e.SheetNames){const s=e.Sheets[n],a=l(s),r=u.utils.sheet_to_json(s);t.push({header:a,results:r,meta:{sheetName:n}})}return t}(u.read(n,{type:"array"}));s("success",a),t("")}catch(e){n(e),s("error")}finally{r.value=!1}},a.readAsArrayBuffer(e)}))}return{handleUpload:function(){const e=n(a);e&&e.click()},handleInputClick:function(e){const t=e&&e.target.files,s=t&&t[0];s&&async function(e){const t=n(a);t&&(t.value=""),await o(e)}(s)},inputRef:a}}});i.render=function(e,t,n,u,i,f){return s(),a("div",null,[r(o("input",{ref:"inputRef",type:"file",accept:".xlsx, .xls",onChange:t[1]||(t[1]=(...t)=>e.handleInputClick&&e.handleInputClick(...t))},null,544),[[l,!1]]),o("div",{onClick:t[2]||(t[2]=(...t)=>e.handleUpload&&e.handleUpload(...t))},[c(e.$slots,"default")])])};export default i;