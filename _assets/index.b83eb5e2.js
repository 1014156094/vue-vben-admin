import{k as e,x as t,W as n,u as o,q as a,a7 as r,f as l,a as s,a9 as i,a2 as c,by as u,bz as f,bA as d,bB as p,r as g,v as m,aq as b,Y as h,bC as v,ak as y,a4 as w,F as O,a8 as L,U as x,a6 as H,bD as C,bE as S,b as j,aS as F,bF as P,bG as k,t as M,an as B,z as E}from"./index.3e933661.js";import{C as z}from"./CloseOutlined.09b38309.js";import{a as N}from"./index.243e732a.js";import{u as T}from"./useTimeout.7f3ab19b.js";import{u as W}from"./useDebounce.388ff7a2.js";import{a as A,r as $}from"./resizeEvent.374e9514.js";import{s as q}from"./index.0e9d4f93.js";import{u as R}from"./useWindowSizeFn.6fb915be.js";var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(o,a){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){I(e,t,n[t])}))}return e}({},o,a.attrs);return e(n,t(r,{icon:D}),null)};Y.displayName="FullscreenExitOutlined",Y.inheritAttrs=!1;var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=function(o,a){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){X(e,t,n[t])}))}return e}({},o,a.attrs);return e(n,t(r,{icon:G}),null)};U.displayName="FullscreenOutlined",U.inheritAttrs=!1;const{t:J}=o(),K={visible:a.bool,draggable:a.bool.def(!0),centered:a.bool,cancelText:a.string.def(J("component.modal.cancelText")),okText:a.string.def(J("component.modal.okText")),closeFunc:Function},Q=Object.assign({},K,{canFullscreen:a.bool.def(!0),wrapperFooterOffset:a.number.def(0),helpMessage:[String,Array],useWrapper:a.bool.def(!0),loading:a.bool,showCancelBtn:a.bool.def(!0),showOkBtn:a.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:Boolean,destroyOnClose:Boolean,footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:Boolean,width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function V(e){const t=(e,t)=>getComputedStyle(e)[t],n=n=>{if(!n)return;n.setAttribute("data-drag",l(e.draggable));const o=n.querySelector(".ant-modal-header"),a=n.querySelector(".ant-modal");o&&a&&l(e.draggable)&&(o.style.cursor="move",o.onmousedown=e=>{if(!e)return;const n=e.clientX,o=e.clientY,r=document.body.clientWidth,l=document.documentElement.clientHeight,s=a.offsetWidth,i=a.offsetHeight,c=a.offsetLeft,u=r-a.offsetLeft-s,f=a.offsetTop,d=l-a.offsetTop-i,p=t(a,"left"),g=t(a,"top");let m=+p,b=+g;p.includes("%")?(m=+document.body.clientWidth*(+p.replace(/%/g,"")/100),b=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(m=+p.replace(/px/g,""),b=+g.replace(/px/g,"")),document.onmousemove=function(e){let t=e.clientX-n,r=e.clientY-o;-t>c?t=-c:t>u&&(t=u),-r>f?r=-f:r>d&&(r=d),a.style.cssText+=`;left:${t+m}px;top:${r+b}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};r((()=>{l(e.visible)&&l(e.draggable)&&T((()=>{(()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const a of Array.from(o)){if(!a)continue;const o=t(a,"display"),r=a.getAttribute("data-drag");"none"!==o&&(null===r||l(e.destroyOnClose))&&n(a)}})()}),30)}))}var Z=s({name:"Modal",inheritAttrs:!1,props:Q,setup(e,{attrs:t,slots:n}){const{visible:o,draggable:a,destroyOnClose:r}=i(e);return V({visible:o,destroyOnClose:r,draggable:a}),()=>{const o={...t,...e};return c(f,{...o},u(n))}}});const _=Symbol();function ee(){return p(_)}var te=s({name:"ModalWrapper",props:{loading:a.bool,modalHeaderHeight:a.number.def(50),modalFooterHeight:a.number.def(54),minHeight:a.number.def(200),footerOffset:a.number.def(0),visible:a.bool,fullScreen:a.bool},emits:["heightChange","getExtHeight"],setup(e,{slots:t,emit:n}){const o=g(null),a=g(null),s=g(0);let i=()=>{};R(f),d({redoModalHeight:f},_);const u=m((()=>({minHeight:`${e.minHeight}px`,height:`${l(s)}px`,overflow:"auto"})));async function f(){if(!e.visible)return;const t=l(o);if(!t)return;const r=t.parentElement;if(r){r.style.padding="0",await O();try{const t=r.parentElement&&r.parentElement.parentElement;if(!t)return;const o=getComputedStyle(t).top,i=Number.parseInt(o);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),await O();const u=l(a);if(!u)return;const f=u.$el.querySelector(".ant-spin-container");if(!f)return;const d=f.scrollHeight;e.fullScreen?s.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight:s.value=d>c?c:d+16+30,n("heightChange",l(s)),O((()=>{const e=u.$el;e&&(e.style.height=`${l(s)}px`)}))}catch(e){}}}return r((()=>{f()})),b((()=>e.fullScreen),(e=>{!e&&f()})),h((()=>{const{modalHeaderHeight:t,modalFooterHeight:a}=e;n("getExtHeight",t+a),function(){const e=l(o);if(!e)return;const t=e.querySelector(".ant-spin-container");if(!t)return;const[n,a]=function(e,t,n=100,o){let a=()=>{t()};const[r,l]=W(a,n,o);return a=n?r:a,[function(){A(e,a)},function(){$(e,a),l()}]}(t,(()=>{f()}));i=a,n()}()})),v((()=>{i&&i()})),()=>c("div",{ref:o,style:l(u)},c(y,{ref:a,spinning:e.loading},(()=>w(t))))}});var ne=s({name:"BasicModal",props:Q,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{slots:t,emit:n,attrs:o}){const a=g(!1),s=g(null),i=g(null),f=g(0),d=m((()=>({...e,...l(s)}))),{handleFullScreen:p,getWrapClassName:h,fullScreenRef:v}=function(e){const t=g(0),n=g(!1);return{getWrapClassName:m((()=>{const t=l(e.wrapClassName)||"";return l(n)?`fullscreen-modal ${t} `:l(t)})),handleFullScreen:function(o){o&&o.stopPropagation(),n.value=!l(n);const a=l(e.modalWrapperRef);if(!a)return;const r=a.$el;if(!r)return;const s=r.querySelector(".ant-spin-nested-loading");s&&(!l(t)&&l(n)&&(t.value=s.offsetHeight),l(n)?s.style.height=window.innerHeight-l(e.extHeightRef)+"px":s.style.height=`${l(t)}px`)},fullScreenRef:n}}({modalWrapperRef:i,extHeightRef:f,wrapClassName:L(d.value,"wrapClassName")}),y=m((()=>({...{...l(d),visible:l(a),title:void 0},wrapClassName:l(h)}))),O=m((()=>({...o,...l(y)})));async function j(t){if(null==t||t.stopPropagation(),e.closeFunc&&H(e.closeFunc)){const t=await e.closeFunc();a.value=!t}else a.value=!1,n("cancel")}r((()=>{a.value=!!e.visible})),b((()=>l(a)),(e=>{n("visible-change",e)}),{immediate:!1});const F={setModalProps:function(e){s.value=S(l(s)||{},e),Reflect.has(e,"visible")&&(a.value=!!e.visible)}};return C((e=>{n("register",F,e.uid)})),()=>c(Z,{onCancel:j,...l(O)},{footer:()=>function(){const{showCancelBtn:e,cancelButtonProps:o,cancelText:a,showOkBtn:r,okType:s,okText:i,okButtonProps:u,confirmLoading:f}=l(y);return c(x,null,w(t,"insertFooter"),e&&c(q,{...o,onClick:j},(()=>a)),w(t,"centerdFooter"),r&&c(q,{type:s,loading:f,onClick:()=>{n("ok")},...u},(()=>i)),w(t,"appendFooter"))}(),closeIcon:()=>function(){const{canFullscreen:e}=l(y),t=l(v)?c(Y,{role:"full",onClick:p}):c(U,{role:"close",onClick:p});return c("div",{class:["custom-close-icon",{"can-full":e}]},e&&t,c(z,{onClick:j}))}(),title:()=>function(){const{helpMessage:e}=l(y),{title:n}=l(d);return c(N,{helpMessage:e},(()=>t.title?w(t,"title"):n))}(),...u(t,["default"]),default:()=>function(){const{useWrapper:o,loading:r,wrapperProps:s}=l(y);if(!o)return w(t);const u=void 0===e.footer||e.footer?void 0:0;return c(te,{footerOffset:e.wrapperFooterOffset,fullScreen:l(v),ref:i,loading:r,visible:l(a),modalFooterHeight:u,...s,onGetExtHeight:e=>{f.value=e},onHeightChange:e=>{n("height-change",e)}},(()=>w(t)))}()})}});const oe=j({});function ae(){if(!F())throw new Error("Please put useModal function in the setup function!");const e=g(null),t=g(!1),n=g("");const o=()=>{const t=l(e);if(!t)throw new Error("instance is undefined!");return t};return[function(o,a){n.value=a,v((()=>{e.value=null,t.value=!1,oe[l(n)]=null})),l(t)&&P()&&o===l(e)||(e.value=o)},{setModalProps:e=>{o().setModalProps(e)},openModal:(e=!0,t,a=!1)=>{if(o().setModalProps({visible:e}),!t)return;if(a)return oe[l(n)]=null,void(oe[l(n)]=t);k(M(oe[l(n)]),t)||(oe[l(n)]=t)}}]}const re=e=>{const t=g(null),n=F(),o=g("");if(!n)throw new Error("instance is undefined!");const a=()=>{const e=l(t);if(!e)throw new Error("instance is undefined!");return e};return r((()=>{const t=oe[l(o)];t&&e&&H(e)&&O((()=>{e(t)}))})),[(e,a)=>{B((()=>{t.value=null})),o.value=a,t.value=e,n.emit("register",e)},{changeLoading:(e=!0)=>{a().setModalProps({loading:e})},changeOkLoading:(e=!0)=>{a().setModalProps({confirmLoading:e})},closeModal:()=>{a().setModalProps({visible:!1})},setModalProps:e=>{a().setModalProps(e)}}]};E(ne);export{ne as B,Y as F,re as a,U as b,ee as c,ae as u};