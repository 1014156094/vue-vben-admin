import{q as e,a as t,r as n,v as s,Y as l,F as o,bC as i,f as c,a2 as a,U as r,c2 as d,I as u,cd as m,k as p,ce as h,aS as v}from"./index.3e933661.js";import{D as y}from"./index.d8b61c9c.js";const f={width:e.number.def(156),customEvent:{type:Object,default:null},styles:e.style,showIcon:e.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},b=e=>{const{item:t}=e;return a("span",{style:"display: inline-block; width: 100%;",onClick:e.handler.bind(null,t)},e.showIcon&&t.icon&&a(u,{class:"mr-2",icon:t.icon}),a("span",null,t.label))};var x=t({name:"ContextMenu",props:f,setup(e){const t=n(null),u=n(!1),m=s((()=>{const{axis:t,items:n,styles:s,width:l}=e,{x:o,y:i}=t||{x:0,y:0},c=40*(n||[]).length,a=l,r=document.body;return{...s,width:`${l}px`,left:`${(r.clientWidth<o+a?o-a:o)+1}px`,top:`${(r.clientHeight<i+c?i-c:i)+1}px`}}));function p(e,t){const{handler:n,disabled:s}=e;s||(u.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function h(t){return t.map((t=>{const{disabled:n,label:s,children:l,divider:o=!1}=t,i=o?a(y,{key:`d-${s}`}):null;return l&&0!==l.length?c(u)?a(d.SubMenu,{key:s,disabled:n,popupClassName:"context-menu__popup"},{title:()=>a(b,{showIcon:e.showIcon,item:t,handler:p}),default:()=>h(l)}):null:a(r,null,a(d.Item,{disabled:n,class:"context-menu__item",key:s},(()=>[a(b,{showIcon:e.showIcon,item:t,handler:p})])),i)}))}return l((()=>{o((()=>u.value=!0))})),i((()=>{const e=c(t);e&&document.body.removeChild(e)})),()=>{const{items:n}=e;return c(u)?a(d,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:t,style:c(m)},(()=>h(n))):null}}});const w={domList:[],resolve:()=>{}},I=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),m)return new Promise((n=>{const s=document.body,l=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const i=p(x,o);h(i,l);const c=function(){w.resolve("")};w.domList.push(l);const a=function(){w.domList.forEach((e=>{try{e&&s.removeChild(e)}catch(e){}})),s.removeEventListener("click",c),s.removeEventListener("scroll",c)};w.resolve=function(...e){a(),n(e[0])},a(),s.appendChild(l),s.addEventListener("click",c),s.addEventListener("scroll",c)}))},k=function(){w&&(w.resolve(""),w.domList=[])};function E(e=!0){return v()&&e&&i((()=>{k()})),[I,k]}export{E as u};