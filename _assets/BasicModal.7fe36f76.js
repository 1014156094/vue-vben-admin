import{u as e,q as t,ae as o,f as n,a as l,a7 as a,R as r,a$ as s,r as i,s as c,O as u,Q as d,d4 as f,bJ as p,F as m,av as g,dv as h,ad as b,cJ as y,d2 as v}from"./index.db24b8f1.js";import"./xlsx.a48e520c.js";import{C as H}from"./CloseOutlined.6711d54c.js";import{F as x,a as C}from"./FullscreenOutlined.2c746cdc.js";import{u as w}from"./useTimeout.8adf281f.js";import{u as F}from"./useDebounce.8dbcf364.js";import{e as S,g as O}from"./tsxHelper.00e8ba63.js";import{a as j}from"./index.ac876ed0.js";import"./index.53d2c82a.js";import{s as k}from"./index.c5a5f0b0.js";import{c as B}from"./useModalContext.95ebeccd.js";import{u as T}from"./useWindowSizeFn.2b8923c5.js";import{a as W,r as $}from"./resizeEvent.35a77596.js";const{t:N}=e(),E={visible:t.bool,draggable:t.bool.def(!0),centered:t.bool,cancelText:t.string.def(N("component.modal.cancelText")),okText:t.string.def(N("component.modal.okText")),closeFunc:Function},M=Object.assign({},E,{canFullscreen:t.bool.def(!0),wrapperFooterOffset:t.number.def(0),helpMessage:[String,Array],useWrapper:t.bool.def(!0),loading:t.bool,showCancelBtn:t.bool.def(!0),showOkBtn:t.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:Boolean,destroyOnClose:Boolean,footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:Boolean,width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function P(e){const t=(e,t)=>getComputedStyle(e)[t],l=o=>{if(!o)return;o.setAttribute("data-drag",n(e.draggable));const l=o.querySelector(".ant-modal-header"),a=o.querySelector(".ant-modal");l&&a&&n(e.draggable)&&(l.style.cursor="move",l.onmousedown=e=>{if(!e)return;const o=e.clientX,n=e.clientY,l=document.body.clientWidth,r=document.documentElement.clientHeight,s=a.offsetWidth,i=a.offsetHeight,c=a.offsetLeft,u=l-a.offsetLeft-s,d=a.offsetTop,f=r-a.offsetTop-i,p=t(a,"left"),m=t(a,"top");let g=+p,h=+m;p.includes("%")?(g=+document.body.clientWidth*(+p.replace(/%/g,"")/100),h=+document.body.clientHeight*(+m.replace(/%/g,"")/100)):(g=+p.replace(/px/g,""),h=+m.replace(/px/g,"")),document.onmousemove=function(e){let t=e.clientX-o,l=e.clientY-n;-t>c?t=-c:t>u&&(t=u),-l>d?l=-d:l>f&&(l=f),a.style.cssText+=`;left:${t+g}px;top:${l+h}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};o((()=>{n(e.visible)&&n(e.draggable)&&w((()=>{(()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const a of Array.from(o)){if(!a)continue;const o=t(a,"display"),r=a.getAttribute("data-drag");"none"!==o&&(null===r||n(e.destroyOnClose))&&l(a)}})()}),30)}))}var R=l({name:"Modal",inheritAttrs:!1,props:M,setup(e,{attrs:t,slots:o}){const{visible:n,draggable:l,destroyOnClose:i}=a(e);return P({visible:n,destroyOnClose:i,draggable:l}),()=>{const n={...t,...e};return r(s,{...n},S(o))}}});var q=l({name:"ModalWrapper",props:{loading:t.bool,modalHeaderHeight:t.number.def(50),modalFooterHeight:t.number.def(54),minHeight:t.number.def(200),footerOffset:t.number.def(0),visible:t.bool,fullScreen:t.bool},emits:["heightChange","getExtHeight"],setup(e,{slots:t,emit:l}){const a=i(null),s=i(null),g=i(0);let h=()=>{};T(y),B({redoModalHeight:y});const b=c((()=>({minHeight:`${e.minHeight}px`,height:`${n(g)}px`,overflow:"auto"})));async function y(){if(!e.visible)return;const t=n(a);if(!t)return;const o=t.parentElement;if(o){o.style.padding="0",await m();try{const t=o.parentElement&&o.parentElement.parentElement;if(!t)return;const a=getComputedStyle(t).top,r=Number.parseInt(a);let i=window.innerHeight-2*r+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;r<40&&(i-=26),await m();const c=n(s);if(!c)return;const u=c.$el.querySelector(".ant-spin-container");if(!u)return;const d=u.scrollHeight;e.fullScreen?g.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight:g.value=d>i?i:d+16+30,l("heightChange",n(g)),m((()=>{const e=c.$el;e&&(e.style.height=`${n(g)}px`)}))}catch(e){}}}return o((()=>{y()})),u((()=>e.fullScreen),(e=>{!e&&y()})),d((()=>{const{modalHeaderHeight:t,modalFooterHeight:o}=e;l("getExtHeight",t+o),function(){const e=n(a);if(!e)return;const t=e.querySelector(".ant-spin-container");if(!t)return;const[o,l]=function(e,t,o=100,n){let l=()=>{t()};const[a,r]=F(l,o,n);return l=o?a:l,[function(){W(e,l)},function(){$(e,l),r()}]}(t,(()=>{y()}));h=l,o()}()})),f((()=>{h&&h()})),()=>r("div",{ref:a,style:n(b)},r(p,{ref:s,spinning:e.loading},(()=>O(t))))}});var A=l({name:"BasicModal",props:M,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{slots:t,emit:l,attrs:a}){const s=i(!1),d=i(null),f=i(null),p=i(0),m=c((()=>({...e,...n(d)}))),{handleFullScreen:w,getWrapClassName:F,fullScreenRef:B}=function(e){const t=i(0),o=i(!1);return{getWrapClassName:c((()=>{const t=n(e.wrapClassName)||"";return n(o)?`fullscreen-modal ${t} `:n(t)})),handleFullScreen:function(l){l&&l.stopPropagation(),o.value=!n(o);const a=n(e.modalWrapperRef);if(!a)return;const r=a.$el;if(!r)return;const s=r.querySelector(".ant-spin-nested-loading");s&&(!n(t)&&n(o)&&(t.value=s.offsetHeight),n(o)?s.style.height=window.innerHeight-n(e.extHeightRef)+"px":s.style.height=`${n(t)}px`)},fullScreenRef:o}}({modalWrapperRef:f,extHeightRef:p,wrapClassName:g(m.value,"wrapClassName")}),T=c((()=>({...{...n(m),visible:n(s),title:void 0},wrapClassName:n(F)}))),W=c((()=>({...a,...n(T)})));async function $(t){if(null==t||t.stopPropagation(),e.closeFunc&&y(e.closeFunc)){const t=await e.closeFunc();s.value=!t}else s.value=!1,l("cancel")}o((()=>{s.value=!!e.visible})),u((()=>n(s)),(e=>{l("visible-change",e)}),{immediate:!1});const N={setModalProps:function(e){d.value=v(n(d)||{},e),Reflect.has(e,"visible")&&(s.value=!!e.visible)}};return h((e=>{l("register",N,e.uid)})),()=>r(R,{onCancel:$,...n(W)},{footer:()=>function(){const{showCancelBtn:e,cancelButtonProps:o,cancelText:a,showOkBtn:s,okType:i,okText:c,okButtonProps:u,confirmLoading:d}=n(T);return r(b,null,O(t,"insertFooter"),e&&r(k,{...o,onClick:$},(()=>a)),O(t,"centerdFooter"),s&&r(k,{type:i,loading:d,onClick:()=>{l("ok")},...u},(()=>c)),O(t,"appendFooter"))}(),closeIcon:()=>function(){const{canFullscreen:e}=n(T),t=n(B)?r(x,{role:"full",onClick:w}):r(C,{role:"close",onClick:w});return r("div",{class:["custom-close-icon",{"can-full":e}]},e&&t,r(H,{onClick:$}))}(),title:()=>function(){const{helpMessage:e}=n(T),{title:o}=n(m);return r(j,{helpMessage:e},(()=>t.title?O(t,"title"):o))}(),...S(t,["default"]),default:()=>function(){const{useWrapper:o,loading:a,wrapperProps:i}=n(T);if(!o)return O(t);const c=void 0===e.footer||e.footer?void 0:0;return r(q,{footerOffset:e.wrapperFooterOffset,fullScreen:n(B),ref:f,loading:a,visible:n(s),modalFooterHeight:c,...i,onGetExtHeight:e=>{p.value=e},onHeightChange:e=>{l("height-change",e)}},(()=>O(t)))}()})}});export default A;