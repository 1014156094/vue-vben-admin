let i=document.createElement("style");i.innerHTML=".ir-dv{position:relative;display:flex;flex-direction:column;align-items:center}.ir-dv-img__wrap{position:relative;overflow:hidden;border-radius:50%}.ir-dv-img__wrap img{width:100%;border-radius:50%}.ir-dv-img__wrap img.to-origin{transition:transform .3s}.ir-dv-img__tip{position:absolute;bottom:10px;left:0;z-index:1;display:block;width:100%;height:30px;font-size:12px;line-height:30px;color:#fff;text-align:center}.ir-dv-img__tip.success{background:rgba(85,209,135,.6)}.ir-dv-img__tip.error{background:rgba(237,111,111,.6)}.ir-dv-img__tip.normal{background:rgba(0,0,0,.3)}.ir-dv-drag__bar{margin-top:20px}",document.head.appendChild(i);import{a as t,r as e,b as r,u as s,X as a,I as o,az as n,f as m,cM as d}from"./index.a6ab9244.js";import"./xlsx.9d951958.js";import"./_baseSlice.1123a25b.js";import"./_stringToArray.943e7f6c.js";import{h as g}from"./domUtils.409025a3.js";import"./CheckOutlined.5f43e1c7.js";import"./DoubleRightOutlined.2732270b.js";import{u as c}from"./useTimeout.a76b8678.js";import"./tsxHelper.6b46956f.js";import"./useExpose.37206cdb.js";import{r as p,B as l}from"./DragVerify.f55957db.js";var u=t({name:"ImgRotateDargVerify",inheritAttrs:!1,props:p,emits:["success","change","update:value"],setup(i,{emit:t,attrs:p}){const u=e(null),f=r({showTip:!1,isPassing:!1,imgStyle:{},randomRotate:0,currentRotate:0,toOrigin:!1,startTime:0,endTime:0,draged:!1}),{t:h}=s();a((()=>f.isPassing),(i=>{if(i){const{startTime:e,endTime:r}=f;t("success",{isPassing:i,time:((r-e)/1e3).toFixed(1)}),t("change",i),t("update:value",i)}}));const v=o((()=>{const{imgWrapStyle:t,imgWidth:e}=i;return{width:`${e}px`,height:`${e}px`,...t}})),_=o((()=>{const{minDegree:t,maxDegree:e}=i;return t===e?Math.floor(1+1*Math.random())/10+1:1}));function b(){f.startTime=(new Date).getTime()}function x(t){f.draged=!0;const{imgWidth:e,height:r,maxDegree:s}=i,{moveX:a}=t,o=Math.ceil(a/(e-parseInt(r))*s*m(_));f.currentRotate=o,f.imgStyle=g("transform",`rotateZ(${f.randomRotate-o}deg)`)}function T(){const{minDegree:t,maxDegree:e}=i,r=Math.floor(t+Math.random()*(e-t));f.randomRotate=r,f.imgStyle=g("transform",`rotateZ(${r}deg)`)}function w(){const{randomRotate:t,currentRotate:e}=f,{diffDegree:r}=i;Math.abs(t-e)>=(r||20)?(f.imgStyle=g("transform",`rotateZ(${t}deg)`),f.toOrigin=!0,c((()=>{f.toOrigin=!1,f.showTip=!0}),300)):(f.isPassing=!0,f.endTime=(new Date).getTime()),f.showTip=!0}function y(){f.showTip=!1;const i=m(u);i&&(f.isPassing=!1,i.resume(),T())}const j=d();return j&&(j.resume=y),()=>{const{src:t}=i,{toOrigin:e,isPassing:r,startTime:s,endTime:a}=f,o=[];e&&o.push("to-origin");const d=(a-s)/1e3;return n("div",{class:"ir-dv"},n("div",{class:"ir-dv-img__wrap",style:m(v)},n("img",{src:t,onLoad:T,width:parseInt(i.width),class:o,style:f.imgStyle,onClick:()=>{y()}}),f.showTip&&n("span",{class:["ir-dv-img__tip",f.isPassing?"success":"error"]},f.isPassing?h("component.verify.time",{time:d.toFixed(1)}):h("component.verify.error")),!f.showTip&&!f.draged&&n("span",{class:["ir-dv-img__tip","normal"]},"t('redoTip')")),n(l,{class:"ir-dv-drag__bar",onMove:x,onEnd:w,onStart:b,ref:u,...{...p,...i},value:r,isSlot:!0}))}}});export default u;